(this["webpackJsonpmy-page-react"]=this["webpackJsonpmy-page-react"]||[]).push([[0],{46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},54:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=54},56:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(34),r=a.n(i),s=(a(46),a(47),a(48),a(49),a(3)),o=a(41),l=a(38),u=a.n(l),d=443,j="/socket",f="/peer",m=a(1),v=c.a.createContext(),b=Object(o.a)({port:d,path:j}),h=new u.a({host:"/",port:d,path:f,secure:!0,debug:3}),p=function(e){var t=e.children,a=c.a.useState(!0),n=Object(s.a)(a,2),i=n[0],r=n[1],o=c.a.useState(""),l=Object(s.a)(o,2),u=l[0],d=l[1],j=c.a.useState(!1),f=Object(s.a)(j,2),p=f[0],x=f[1],O=c.a.useState([0,0]),g=Object(s.a)(O,2),S=g[0],N=g[1],k=c.a.useState(!1),y=Object(s.a)(k,2),T=y[0],w=y[1],C=c.a.useState(!1),M=Object(s.a)(C,2),L=M[0],D=M[1],P=c.a.useState(!1),E=Object(s.a)(P,2),H=E[0],F=E[1],R=c.a.useState(null),V=Object(s.a)(R,2),$=V[0],J=V[1];return c.a.useEffect((function(){F(!(!T||!L))}),[T,L]),b.on("connect",(function(){w(!0)})),h.on("open",(function(e){D(!0)})),b.on("disconnect",(function(){w(!1)})),h.on("disconnected",(function(){D(!1)})),Object(m.jsx)(v.Provider,{value:{getDarkMode:i,setDarkMode:r,enableTooltip:function(e,t){var a=t.right-t.left,n=t.left+a/2,c=window.innerWidth-t.right+a/2;d(e),N([n,c]),x(!0)},disableTooltip:function(){x(!1)},getTooltipText:u,getTooltipVisibility:p,getTooltipDistances:S,isStreamService:H,getStream:$,startStream:function(e){J(e),b.on("viewerJoining",(function(t){h.call(t,e),console.log("User ".concat(t," joined"))})),b.on("viewerLeaving",(function(e){console.log("User ".concat(e," left"))})),b.emit("registerStream"),e.getVideoTracks()[0].addEventListener("ended",(function(){b.emit("deregisterStream"),b.off("viewerJoining"),b.off("viewerLeaving"),J(null)}))},joinStream:function(e,t){b.id===e?t($):(b.on("viewerJoining",(function(e){console.log("User ".concat(e," joined"))})),b.on("viewerLeaving",(function(e){console.log("User ".concat(e," left"))})),h.on("call",(function(e){e.answer(),e.on("stream",(function(e){t(e)}))}))),b.emit("joinStream",e,h.id)},leaveStream:function(e){b.id!==e&&(b.off("viewerJoining"),b.off("viewerLeaving"),h.off("call")),b.emit("leaveStream",e,h.id)}},children:t})};function x(e){var t=e.props,a=c.a.useContext(v),n=a.getDarkMode,i=a.enableTooltip,r=a.disableTooltip,s=c.a.useRef(),o=t.position?"on":"off",l=n?"dark":"light";return Object(m.jsx)("div",{className:"Switch ".concat(l),ref:s,onClick:t.callback,onMouseOver:function(){return i("Dark mode",s.current.getBoundingClientRect())},onMouseOut:function(){return r()},children:Object(m.jsx)("div",{className:"Switch-thumb ".concat(l," ").concat(o)})})}a(56);function O(e){e.props;var t=c.a.useContext(v),a=t.getDarkMode,n=t.getTooltipText,i=t.getTooltipVisibility,r=t.getTooltipDistances,s=c.a.useRef(),o=a?"dark":"light",l=i?"active":"idle";return c.a.useEffect((function(){var e=r[0],t=r[1],a=s.current.offsetWidth;if(e<a/2)s.current.style.left="0px",s.current.style.right="auto";else if(t<a/2)s.current.style.right="0px",s.current.style.left="auto";else{var n=e-a/2;s.current.style.left=n+"px",s.current.style.right="auto"}}),[r]),Object(m.jsx)("div",{className:"Tooltip ".concat(l," ").concat(o),ref:s,children:n})}var g=a(19);function S(){var e=c.a.useContext(v),t=e.getDarkMode,a=e.setDarkMode,n=e.enableTooltip,i=e.disableTooltip,r=t?"dark":"light",s=c.a.useRef(),o=c.a.useRef(),l={position:t,callback:function(){a((function(e){return!e}))}};return c.a.useEffect((function(){function e(e){e.preventDefault(),o.current.scrollLeft+=e.deltaY}return o.current.addEventListener("wheel",e),function(){o.current.removeEventListener("wheel",e)}}),[]),Object(m.jsxs)("div",{className:"Header ".concat(r),children:[Object(m.jsxs)("div",{className:"Header-content",children:[Object(m.jsx)(g.b,{to:"/",children:Object(m.jsx)("div",{className:"Header-home ".concat(r),ref:s,onMouseOver:function(){return n("Home",s.current.getBoundingClientRect())},onMouseOut:function(){return i()}})}),Object(m.jsx)("div",{className:"Header-gap"}),Object(m.jsx)("div",{className:"Header-icons",ref:o,children:Object(m.jsx)(x,{props:l})}),Object(m.jsx)("div",{className:"Header-gap"})]}),Object(m.jsx)(O,{})]})}var N=a(2);a(61);function k(){var e=c.a.useContext(v).getDarkMode?"dark":"light";return Object(m.jsxs)("div",{className:"Home",children:[Object(m.jsx)(g.b,{to:"/fuel",children:Object(m.jsx)("div",{className:"Home-item Home-fuel ".concat(e)})}),Object(m.jsx)("div",{className:"Home-item Home-gamepad ".concat(e)}),Object(m.jsx)(g.b,{to:"/streams",children:Object(m.jsx)("div",{className:"Home-item Home-streaming ".concat(e)})})]})}a(62),a(63);function y(e){var t=e.props,a=c.a.useContext(v).getDarkMode?"dark":"light",n=t.validityState[0]?"valid":"invalid",i=Object(s.a)(t.valueState,2),r=i[0],o=i[1];return Object(m.jsx)("input",{className:"Input ".concat(a," ").concat(n),placeholder:t.placeholder,value:r,onChange:function(e){!function(e){var a=e.target.value;"regex"in t?t.regex.test(a)&&o(a):o(a)}(e)},onFocus:t.onClick})}function T(){var e=c.a.useContext(v).getDarkMode?"dark":"light",t=c.a.useState(!1),a=Object(s.a)(t,2),n=a[0],i=a[1],r=c.a.useState(0),o=Object(s.a)(r,2),l=o[0],u=o[1],d={lapTimeMin:c.a.useState(""),lapTimeS:c.a.useState(""),lapTimeMS:c.a.useState(""),fuelPerLap:c.a.useState(""),raceLength:c.a.useState(""),fuelPer100:c.a.useState(""),distance:c.a.useState(""),fuel:c.a.useState("")},j={lapTime:c.a.useState(!0),fuelPerLap:c.a.useState(!0),raceLength:c.a.useState(!0),fuelPer100:c.a.useState(!0),distance:c.a.useState(!0)},f={valueState:d.lapTimeMin,validityState:j.lapTime,placeholder:"min",onClick:function(){j.lapTime[1](!0)},regex:/^\d{0,2}$/},b={valueState:d.lapTimeS,validityState:j.lapTime,placeholder:"s",onClick:function(){j.lapTime[1](!0)},regex:/^[0-5]?[0-9]?$/},h={valueState:d.lapTimeMS,validityState:j.lapTime,placeholder:"ms",onClick:function(){j.lapTime[1](!0)},regex:/^\d{0,2}$/},p={valueState:d.fuelPerLap,validityState:j.fuelPerLap,placeholder:"l",onClick:function(){j.fuelPerLap[1](!0)},regex:/^(\d{0,2}|\d{1,2}\.\d?)$/},x={valueState:d.raceLength,validityState:j.raceLength,placeholder:"min",onClick:function(){j.raceLength[1](!0)},regex:/^\d{0,4}$/},O={valueState:d.fuelPer100,validityState:j.fuelPer100,placeholder:"l",onClick:function(){j.fuelPer100[1](!0)},regex:/^(\d{0,2}|\d{1,2}\.\d?)$/},g={valueState:d.distance,validityState:j.distance,placeholder:"km",onClick:function(){j.distance[1](!0)},regex:/^\d{0,4}$/};function S(e){i(!0);N({iteration:0,limit:50,valueGap:(e-l)/50,timeGap:10,rawValue:l})}function N(e){if(e.iteration>=e.limit){var t=Math.round(100*(e.rawValue+Number.EPSILON))/100;return t=Math.ceil(t),u(t),void i(!1)}setTimeout((function(){e.rawValue+=e.valueGap,u(Math.ceil(e.rawValue)),e.iteration++,N(e)}),e.timeGap)}return c.a.useEffect((function(){d.fuel[1](l+" l")}),[l]),Object(m.jsxs)("div",{className:"Fuel",children:[Object(m.jsxs)("div",{className:"Fuel-categories",children:[Object(m.jsxs)("div",{className:"Fuel-category",children:[Object(m.jsx)("div",{className:"x0 y0 align-right",children:"Lap time"}),Object(m.jsx)("div",{className:"x1 y0",children:Object(m.jsx)(y,{props:f})}),Object(m.jsx)("div",{className:"x2 y0",children:Object(m.jsx)(y,{props:b})}),Object(m.jsx)("div",{className:"x3 y0",children:Object(m.jsx)(y,{props:h})}),Object(m.jsx)("div",{className:"x0 y1 align-right",children:"Fuel per lap"}),Object(m.jsx)("div",{className:"x1 y1",children:Object(m.jsx)(y,{props:p})}),Object(m.jsx)("div",{className:"x0 y2 align-right",children:"Race length"}),Object(m.jsx)("div",{className:"x1 y2",children:Object(m.jsx)(y,{props:x})}),Object(m.jsx)("div",{className:"x03 y3",children:Object(m.jsx)("div",{className:"button ".concat(e),onClick:function(){if(!n){var e=1*d.lapTimeMin[0]*6e4;e+=1*d.lapTimeS[0]*1e3,e+=1*d.lapTimeMS[0];var t=1*d.fuelPerLap[0],a=6e4*d.raceLength[0],c=[];if(0===e&&c.push(j.lapTime[1]),0===t&&c.push(j.fuelPerLap[1]),0===a&&c.push(j.raceLength[1]),c.length>0)c.forEach((function(e){e(!1)}));else S(t*(a/e))}},children:"Calculate race fuel"})})]}),Object(m.jsxs)("div",{className:"Fuel-category",children:[Object(m.jsx)("div",{className:"x0 y0 align-right",children:"Fuel per 100 km"}),Object(m.jsx)("div",{className:"x1 y0",children:Object(m.jsx)(y,{props:O})}),Object(m.jsx)("div",{className:"x0 y1 align-right",children:"Distance"}),Object(m.jsx)("div",{className:"x1 y1",children:Object(m.jsx)(y,{props:g})}),Object(m.jsx)("div",{className:"x01 y2",children:Object(m.jsx)("div",{className:"button ".concat(e),onClick:function(){if(!n){var e=1*d.fuelPer100[0],t=1*d.distance[0],a=[];if(0===e&&a.push(j.fuelPer100[1]),0===t&&a.push(j.distance[1]),a.length>0)a.forEach((function(e){e(!1)}));else S(e*(t/100))}},children:"Calculate road fuel"})})]})]}),Object(m.jsx)("div",{className:"Fuel-result",children:d.fuel[0]})]})}a(64);function w(){var e=c.a.useContext(v),t=e.getDarkMode,a=e.isStreamService,n=e.getStream,i=e.startStream,r=c.a.useState([]),o=Object(s.a)(r,2),l=o[0],u=o[1],d=c.a.useState(!1),j=Object(s.a)(d,2),f=j[0],b=j[1],h=t?"dark":"light",p=a?l.length:"No service",x=a?"visible":"hidden",O=a&&null==n?"visible":"hidden",S=f?"rotating":"still",N=l.map((function(e){return Object(m.jsx)(g.b,{to:"/stream/".concat(e),children:Object(m.jsx)("div",{className:"button ".concat(h),children:e})},e)}));function k(){var e=Date.now();b(!0),fetch(window.location.protocol+"//"+window.location.host+"/api/streams").then((function(t){var a=1e3-(Date.now()-e)%1e3;return setTimeout((function(){b(!1)}),a),t.json()})).then((function(e){u(e)}),(function(e){console.log(e)}))}return c.a.useEffect((function(){a?k():u([])}),[a]),Object(m.jsxs)("div",{className:"Streams-grid",children:[Object(m.jsx)("div",{className:"Streams-header",children:"Streams"}),Object(m.jsx)("div",{className:"Streams-separator ".concat(h)}),Object(m.jsx)("div",{className:"button Streams-start ".concat(h," ").concat(O),onClick:function(){a&&"visible"===O&&navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){i(e)}),(function(e){console.log(e)}))},children:"Start stream"}),Object(m.jsxs)("div",{className:"Streams-available",children:["Available streams: ",p,Object(m.jsx)("div",{className:"Streams-refresh ".concat(S," ").concat(h," ").concat(x),onClick:function(){a&&!f&&"visible"===x&&k()}})]}),Object(m.jsx)("div",{className:"Streams-available-grid",children:N})]})}a(65);var C=a(31);function M(){var e=c.a.useContext(v),t=e.joinStream,a=e.leaveStream,n=e.isStreamService,i=c.a.useState(!1),r=Object(s.a)(i,2),o=r[0],l=r[1],u=c.a.useState(!1),d=Object(s.a)(u,2),j=d[0],f=d[1],b=j?"playing":"paused",h=c.a.useState(!1),p=Object(s.a)(h,2),x=p[0],O=p[1],g=x?"full":"window",S=Object(N.f)().id,k=c.a.useRef(),y=Object(C.b)();c.a.useEffect((function(){return n&&!o&&(t(S,(function(e){k.current.srcObject=e})),l(!0)),function(){o&&a(S)}}),[n,o]);var T=c.a.useCallback((function(e,t){O(e)}),[y]);function w(e){f(e)}return Object(m.jsxs)(C.a,{className:"Stream-wrapper",handle:y,onChange:T,children:[Object(m.jsx)("video",{className:"Stream-player",ref:k,autoPlay:!0,playsInline:!0,muted:!0,onPlay:function(){return w(!0)},onPause:function(){return w(!1)}}),Object(m.jsxs)("div",{className:"Stream-controls",children:[Object(m.jsx)("div",{className:"Stream-control Stream-play ".concat(b),onClick:function(){k.current.paused||k.current.ended?k.current.play():k.current.pause()}}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{}),Object(m.jsx)("div",{className:"Stream-control Stream-full-screen ".concat(g),onClick:function(){y.active?y.exit():y.enter()}})]})]})}function L(){return Object(m.jsxs)(N.c,{children:[Object(m.jsx)(N.a,{exact:!0,path:"/",children:Object(m.jsx)(k,{})}),Object(m.jsx)(N.a,{exact:!0,path:"/fuel",children:Object(m.jsx)(T,{})}),Object(m.jsx)(N.a,{exact:!0,path:"/streams",children:Object(m.jsx)(w,{})}),Object(m.jsx)(N.a,{exact:!0,path:"/stream/:id",children:Object(m.jsx)(M,{})})]})}var D=function(){var e=c.a.useContext(v).getDarkMode?"dark":"light";return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(S,{}),Object(m.jsx)("div",{className:"App-content ".concat(e),children:Object(m.jsx)(L,{})})]})};r.a.render(Object(m.jsx)(p,{children:Object(m.jsx)(g.a,{children:Object(m.jsx)(D,{})})}),document.getElementById("root"))}},[[66,1,2]]]);
//# sourceMappingURL=main.2403cf32.chunk.js.map