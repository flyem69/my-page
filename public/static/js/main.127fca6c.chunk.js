(this.webpackJsonpmy_page_frontend=this.webpackJsonpmy_page_frontend||[]).push([[0],{45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},52:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=52},54:function(e,t,a){},55:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),i=a(33),s=a.n(i),r=(a(45),a(46),a(47),a(9)),l=a(40),o=a(37),u=a.n(o),d=a(1),j=n.a.createContext(),m=Object(l.a)(),f=new u.a,h=function(e){var t=e.children,a=n.a.useState(!0),c=Object(r.a)(a,2),i=c[0],s=c[1],l=n.a.useState(!1),o=Object(r.a)(l,2),u=o[0],h=o[1],v=n.a.useState(!1),x=Object(r.a)(v,2),b=x[0],g=x[1],p=n.a.useState(!1),O=Object(r.a)(p,2),S=O[0],N=O[1],k=n.a.useState(null),y=Object(r.a)(k,2),w=y[0],C=y[1];return n.a.useEffect((function(){N(!(!u||!b))}),[u,b]),m.on("connect",(function(){h(!0)})),f.on("open",(function(e){g(!0)})),m.on("disconnect",(function(){h(!1)})),f.on("disconnected",(function(){g(!1)})),Object(d.jsx)(j.Provider,{value:{getDarkMode:i,setDarkMode:s,isStreamService:S,startStream:function(e){C(e),m.on("viewerJoining",(function(t){f.call(t,e),console.log("User ".concat(t," joined"))})),m.on("viewerLeaving",(function(e){console.log("User ".concat(e," left"))})),m.emit("registerStream"),e.getVideoTracks()[0].addEventListener("ended",(function(){m.emit("deregisterStream"),m.off("viewerJoining"),m.off("viewerLeaving"),C(null)}))},joinStream:function(e,t){m.id===e?t(w):(m.on("viewerJoining",(function(e){console.log("User ".concat(e," joined"))})),m.on("viewerLeaving",(function(e){console.log("User ".concat(e," left"))})),f.on("call",(function(e){e.answer(),e.on("stream",(function(e){t(e)}))}))),m.emit("joinStream",e,f.id)},leaveStream:function(e){m.id!==e&&(m.off("viewerJoining"),m.off("viewerLeaving"),f.off("call")),m.emit("leaveStream",e,f.id)}},children:t})};function v(e){var t=e.props,a=n.a.useContext(j).getDarkMode,c=t.switchPosition,i=t.switchCallback,s=a?"dark":"light",r=c?"50%":"0%";return Object(d.jsx)("div",{className:"Switch ".concat(s),onClick:i,children:Object(d.jsx)("div",{className:"Switch-thumb",style:{left:r}})})}a(54);function x(){var e=n.a.useContext(j),t=e.getDarkMode,a=e.setDarkMode,c=t?"dark":"light",i={switchPosition:t,switchCallback:function(){a((function(e){return!e}))}};return Object(d.jsxs)("div",{className:"Header ".concat(c),children:[Object(d.jsx)("div",{className:"Header-switch",children:Object(d.jsx)(v,{props:i})}),Object(d.jsx)("div",{className:"Header-switchLabel",children:"Dark mode"})]})}var b=a(20),g=a(2),p=(a(55),a.p+"static/media/fuel_canister.03fd969a.svg"),O=a.p+"static/media/gamepad.b51cff24.svg",S=a.p+"static/media/streaming.ae753636.svg";function N(){var e=n.a.useContext(j).getDarkMode?"dark":"light";return Object(d.jsxs)("div",{className:"Home-grid",children:[Object(d.jsx)(b.b,{to:"/fuel",children:Object(d.jsx)("img",{src:p,className:"Home-item ".concat(e),alt:"fuelImage"})}),Object(d.jsx)("img",{src:O,className:"Home-item ".concat(e),alt:"gamepad"}),Object(d.jsx)(b.b,{to:"/streams",children:Object(d.jsx)("img",{src:S,className:"Home-item ".concat(e),alt:"streaming"})})]})}a(60),a(61);function k(e){var t=e.props,a=n.a.useContext(j).getDarkMode?"dark":"light",c=t.validityState[0]?"valid":"invalid",i=Object(r.a)(t.valueState,2),s=i[0],l=i[1];return Object(d.jsx)("input",{className:"SmallInput ".concat(a," ").concat(c),placeholder:t.placeholder,value:s,onChange:function(e){!function(e){var a=e.target.value;"regex"in t?t.regex.test(a)&&l(a):l(a)}(e)},onFocus:t.onClick})}function y(){var e=n.a.useContext(j).getDarkMode?"dark":"light",t=n.a.useState(!1),a=Object(r.a)(t,2),c=a[0],i=a[1],s={lapTimeMin:n.a.useState(""),lapTimeS:n.a.useState(""),lapTimeMS:n.a.useState(""),fuelPerLap:n.a.useState(""),raceLength:n.a.useState(""),fuelPer100:n.a.useState(""),distance:n.a.useState(""),result:n.a.useState("")},l={lapTime:n.a.useState(!0),fuelPerLap:n.a.useState(!0),raceLength:n.a.useState(!0),fuelPer100:n.a.useState(!0),distance:n.a.useState(!0)},o={valueState:s.lapTimeMin,validityState:l.lapTime,placeholder:"min",onClick:function(){l.lapTime[1](!0)},regex:/^\d{0,2}$/},u={valueState:s.lapTimeS,validityState:l.lapTime,placeholder:"s",onClick:function(){l.lapTime[1](!0)},regex:/^[0-5]?[0-9]?$/},m={valueState:s.lapTimeMS,validityState:l.lapTime,placeholder:"ms",onClick:function(){l.lapTime[1](!0)},regex:/^[0-5]?[0-9]?$/},f={valueState:s.fuelPerLap,validityState:l.fuelPerLap,placeholder:"l",onClick:function(){l.fuelPerLap[1](!0)},regex:/^(\d{0,2}|\d{1,2}\.\d?)$/},h={valueState:s.raceLength,validityState:l.raceLength,placeholder:"min",onClick:function(){l.raceLength[1](!0)},regex:/^\d{0,4}$/},v={valueState:s.fuelPer100,validityState:l.fuelPer100,placeholder:"l",onClick:function(){l.fuelPer100[1](!0)},regex:/^(\d{0,2}|\d{1,2}\.\d?)$/},x={valueState:s.distance,validityState:l.distance,placeholder:"km",onClick:function(){l.distance[1](!0)},regex:/^\d{0,4}$/};function b(e){i(!0);var t=Object(r.a)(s.result,2),a=t[0],c=t[1],n=a.substring(0,a.length-2);isNaN(n)?c((n=0)+" l"):n*=1,g({valueGap:e>n?1:-1,timeGap:500/Math.abs(n-e),currentValue:n,targetValue:e})}function g(e){var t=s.result[1];e.currentValue!==e.targetValue?setTimeout((function(){e.currentValue+=e.valueGap,t(e.currentValue+" l"),g(e)}),e.timeGap):i(!1)}return Object(d.jsxs)("div",{className:"Fuel-grid",children:[Object(d.jsxs)("div",{className:"Fuel-category-grid x0 y0",children:[Object(d.jsx)("div",{className:"x0 y0 align-right",children:"Lap time"}),Object(d.jsx)("div",{className:"x1 y0",children:Object(d.jsx)(k,{props:o})}),Object(d.jsx)("div",{className:"x2 y0",children:Object(d.jsx)(k,{props:u})}),Object(d.jsx)("div",{className:"x3 y0",children:Object(d.jsx)(k,{props:m})}),Object(d.jsx)("div",{className:"x0 y1 align-right",children:"Fuel per lap"}),Object(d.jsx)("div",{className:"x1 y1",children:Object(d.jsx)(k,{props:f})}),Object(d.jsx)("div",{className:"x0 y2 align-right",children:"Race length"}),Object(d.jsx)("div",{className:"x1 y2",children:Object(d.jsx)(k,{props:h})}),Object(d.jsx)("div",{className:"x03 y3",children:Object(d.jsx)("div",{className:"button ".concat(e),onClick:function(){if(!c){var e=1*s.lapTimeMin[0]*6e4;e+=1*s.lapTimeS[0]*1e3,e+=1*s.lapTimeMS[0];var t=1*s.fuelPerLap[0],a=6e4*s.raceLength[0],n=[];if(0===e&&n.push(l.lapTime[1]),0===t&&n.push(l.fuelPerLap[1]),0===a&&n.push(l.raceLength[1]),n.length>0)n.forEach((function(e){e(!1)}));else{var i=t*(a/e);b(i=Math.ceil(i))}}},children:"Calculate race fuel"})})]}),Object(d.jsxs)("div",{className:"Fuel-category-grid x1 y0",children:[Object(d.jsx)("div",{className:"x0 y0 align-right",children:"Fuel per 100 km"}),Object(d.jsx)("div",{className:"x1 y0",children:Object(d.jsx)(k,{props:v})}),Object(d.jsx)("div",{className:"x0 y1 align-right",children:"Distance"}),Object(d.jsx)("div",{className:"x1 y1",children:Object(d.jsx)(k,{props:x})}),Object(d.jsx)("div",{className:"x01 y2",children:Object(d.jsx)("div",{className:"button ".concat(e),onClick:function(){if(!c){var e=1*s.fuelPer100[0],t=1*s.distance[0],a=[];if(0===e&&a.push(l.fuelPer100[1]),0===t&&a.push(l.distance[1]),a.length>0)a.forEach((function(e){e(!1)}));else{var n=e*(t/100);b(n=Math.ceil(n))}}},children:"Calculate road fuel"})})]}),Object(d.jsx)("div",{className:"Fuel-result x01 y1",children:s.result[0]})]})}a(62);var w=a.p+"static/media/refresh.4570377c.svg";function C(){var e=n.a.useContext(j),t=e.getDarkMode,a=e.isStreamService,c=e.startStream,i=n.a.useState([]),s=Object(r.a)(i,2),l=s[0],o=s[1],u=n.a.useState(!1),m=Object(r.a)(u,2),f=m[0],h=m[1],v=t?"dark":"light",x=a?l.length:"No service",g=f?"rotating":"still",p=l.map((function(e){return Object(d.jsx)(b.b,{to:"/stream/".concat(e),children:Object(d.jsx)("div",{children:e},e)})}));function O(){var e=Date.now();h(!0),fetch(window.location.protocol+"//"+window.location.host+"/api/streams").then((function(t){var a=1e3-(Date.now()-e)%1e3;return setTimeout((function(){h(!1)}),a),t.json()})).then((function(e){o(e)}),(function(e){console.log(e)}))}return n.a.useEffect((function(){a&&O()}),[a]),Object(d.jsxs)("div",{className:"Streams-grid",children:[Object(d.jsx)("div",{className:"Streams-header",children:"Streams"}),Object(d.jsx)("div",{className:"Streams-separator ".concat(v)}),Object(d.jsx)("div",{className:"button ".concat(v),onClick:function(){a&&navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}).then((function(e){c(e)}),(function(e){console.log(e)}))},children:"Start stream"}),Object(d.jsxs)("div",{className:"Streams-available",children:["Available streams: ",x,Object(d.jsx)("img",{src:w,className:"Streams-refresh ".concat(g," ").concat(v),alt:"refresh",onClick:function(){a&&!f&&O()}})]}),Object(d.jsx)("div",{className:"Streams-available-grid",children:p})]})}a(63);function L(){var e=n.a.useContext(j),t=e.joinStream,a=e.leaveStream,c=e.isStreamService,i=n.a.useState(!1),s=Object(r.a)(i,2),l=s[0],o=s[1],u=Object(g.f)().id,m=n.a.useRef();return n.a.useEffect((function(){return c&&!l&&(t(u,(function(e){m.current.srcObject=e})),o(!0)),function(){l&&a(u)}}),[c,l]),Object(d.jsx)("video",{className:"player",ref:m,autoPlay:!0,controls:!0,playsInline:!0,muted:!0})}function M(){return Object(d.jsx)(b.a,{children:Object(d.jsxs)(g.c,{children:[Object(d.jsx)(g.a,{exact:!0,path:"/",children:Object(d.jsx)(N,{})}),Object(d.jsx)(g.a,{exact:!0,path:"/fuel",children:Object(d.jsx)(y,{})}),Object(d.jsx)(g.a,{exact:!0,path:"/streams",children:Object(d.jsx)(C,{})}),Object(d.jsx)(g.a,{exact:!0,path:"/stream/:id",children:Object(d.jsx)(L,{})})]})})}var T=function(){var e=n.a.useContext(j).getDarkMode?"dark":"light";return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(x,{}),Object(d.jsx)("div",{className:"App-content ".concat(e),children:Object(d.jsx)(M,{})})]})};s.a.render(Object(d.jsx)(h,{children:Object(d.jsx)(T,{})}),document.getElementById("root"))}},[[64,1,2]]]);
//# sourceMappingURL=main.127fca6c.chunk.js.map